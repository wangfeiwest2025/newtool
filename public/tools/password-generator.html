<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Generator - New ToolsHub</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ†Ô∏è</text></svg>">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/fontawesome-all.min.css">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#28a745">
    <style>
        .strength-indicator {
            height: 10px;
            border-radius: 5px;
            background-color: #e9ecef;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .strength-bar {
            height: 100%;
            width: 0%;
            transition: width 0.3s ease, background-color 0.3s ease;
            border-radius: 5px;
        }
        
        .strength-label {
            font-size: 12px;
            margin-top: 5px;
            font-weight: 600;
        }
        
        .strength-weak { background-color: #dc3545; }
        .strength-fair { background-color: #ffc107; }
        .strength-good { background-color: #17a2b8; }
        .strength-strong { background-color: #28a745; }
        
        .generated-password {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            letter-spacing: 2px;
            background-color: #f8f9fa;
        }
        
        .char-type-option {
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .char-type-option:hover {
            border-color: #28a745;
        }
        
        .char-type-option.active {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        
        .char-type-option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .history-item {
            padding: 8px 12px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-password {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg" style="background: linear-gradient(135deg, #28a745, #1e7e34); padding: 1rem 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <div class="container">
            <a class="navbar-brand" href="/" style="color: white; font-weight: 700; display: flex; align-items: center;">
                <i class="fas fa-tools"></i> New ToolsHub
            </a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="tool-container">
            <div class="tool-header">
                <h1 class="tool-title"><i class="fas fa-key"></i> Password Generator</h1>
                <p class="tool-description">Generate secure, random passwords with customizable options. Check password strength and save generated passwords.</p>
            </div>
            
            <div class="tool-content">
                <div class="row">
                    <div class="col-md-8">
                        <div class="form-group">
                            <label for="passwordLength" class="form-label">Password Length:</label>
                            <div class="d-flex align-items-center">
                                <input type="range" id="passwordLength" class="form-range flex-grow-1" min="4" max="64" value="16">
                                <span id="lengthValue" class="badge bg-primary ms-3" style="font-size: 16px;">16</span>
                            </div>
                        </div>
                        
                        <div class="form-group mt-3">
                            <label class="form-label">Character Types:</label>
                            <div class="d-flex flex-wrap gap-2 mt-2">
                                <div class="char-type-option active" data-type="uppercase">
                                    <i class="fas fa-bold"></i> ABC
                                </div>
                                <div class="char-type-option active" data-type="lowercase">
                                    <i class="fas fa-font"></i> abc
                                </div>
                                <div class="char-type-option active" data-type="numbers">
                                    <i class="fas fa-hashtag"></i> 123
                                </div>
                                <div class="char-type-option active" data-type="symbols">
                                    <i class="fas fa-asterisk"></i> !@#
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mt-3">
                            <label for="ambiguousChars" class="form-label">
                                <input type="checkbox" id="ambiguousChars"> Exclude Ambiguous Characters (0, O, l, 1, I)
                            </label>
                        </div>
                        
                        <div class="form-group mt-3">
                            <label for="memorablePassword" class="form-label">
                                <input type="checkbox" id="memorablePassword"> Generate Memorable Password
                            </label>
                        </div>
                        
                        <div class="action-buttons mt-4">
                            <button id="generateBtn" class="btn btn-success btn-lg">
                                <i class="fas fa-random"></i> Generate Password
                            </button>
                            <button id="copyBtn" class="btn btn-outline-primary btn-lg">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button id="clearHistoryBtn" class="btn btn-outline-secondary">
                                <i class="fas fa-trash-alt"></i> Clear History
                            </button>
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-history"></i> Generated Passwords
                            </div>
                            <div class="card-body" id="passwordHistory" style="max-height: 300px; overflow-y: auto; padding: 0;">
                                <div class="text-center text-muted py-3">
                                    No passwords generated yet
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <hr class="my-4">
                
                <div class="form-group">
                    <label for="generatedPassword" class="form-label">Generated Password:</label>
                    <div class="input-group">
                        <input type="text" id="generatedPassword" class="form-control generated-password" readonly placeholder="Click 'Generate Password' to create...">
                        <button id="regenerateBtn" class="btn btn-outline-success" title="Generate Another">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                
                <div class="strength-indicator">
                    <div class="strength-bar" id="strengthBar"></div>
                </div>
                <div class="strength-label" id="strengthLabel">Password Strength: N/A</div>
                
                <div class="result-container mt-3" id="passwordInfo" style="display: none;">
                    <h5>Password Details:</h5>
                    <p id="passwordDetails"></p>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>New ToolsHub - Inspired by xJavaFxTool | Comprehensive Developer Tools</p>
        </div>
    </footer>

    <script>
        // DOM elements
        const passwordLength = document.getElementById('passwordLength');
        const lengthValue = document.getElementById('lengthValue');
        const charTypeOptions = document.querySelectorAll('.char-type-option');
        const generateBtn = document.getElementById('generateBtn');
        const regenerateBtn = document.getElementById('regenerateBtn');
        const copyBtn = document.getElementById('copyBtn');
        const generatedPassword = document.getElementById('generatedPassword');
        const strengthBar = document.getElementById('strengthBar');
        const strengthLabel = document.getElementById('strengthLabel');
        const passwordInfo = document.getElementById('passwordInfo');
        const passwordDetails = document.getElementById('passwordDetails');
        const passwordHistory = document.getElementById('passwordHistory');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const ambiguousChars = document.getElementById('ambiguousChars');
        const memorablePassword = document.getElementById('memorablePassword');
        
        // Character sets
        const charSets = {
            uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            lowercase: 'abcdefghijklmnopqrstuvwxyz',
            numbers: '0123456789',
            symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
        };
        
        const ambiguous = '0O1lI';
        const memorableWords = ['apple', 'brave', 'cloud', 'dance', 'eagle', 'flame', 'grace', 'house', 'image', 'juice', 
                               'kite', 'lemon', 'magic', 'night', 'ocean', 'piano', 'queen', 'river', 'storm', 'tiger',
                               'unity', 'value', 'water', 'xray', 'youth', 'zebra', 'blue', 'gold', 'iron', 'jade'];
        
        // State
        let selectedTypes = ['uppercase', 'lowercase', 'numbers', 'symbols'];
        let passwordHistoryList = JSON.parse(localStorage.getItem('passwordHistory') || '[]');
        
        // Length slider
        passwordLength.addEventListener('input', function() {
            lengthValue.textContent = this.value;
        });
        
        // Character type selection
        charTypeOptions.forEach(option => {
            option.addEventListener('click', function() {
                const type = this.getAttribute('data-type');
                if (this.classList.contains('active')) {
                    // Don't allow deselecting if it's the last type
                    if (selectedTypes.length > 1) {
                        this.classList.remove('active');
                        selectedTypes = selectedTypes.filter(t => t !== type);
                    }
                } else {
                    this.classList.add('active');
                    selectedTypes.push(type);
                }
            });
        });
        
        // Generate password
        function generatePassword() {
            const length = parseInt(passwordLength.value);
            const excludeAmbiguous = ambiguousChars.checked;
            const isMemorable = memorablePassword.checked;
            
            if (isMemorable) {
                return generateMemorablePassword(length);
            }
            
            let chars = '';
            selectedTypes.forEach(type => {
                chars += charSets[type];
            });
            
            if (excludeAmbiguous) {
                chars = chars.split('').filter(c => !ambiguous.includes(c)).join('');
            }
            
            if (!chars) {
                alert('Please select at least one character type');
                return null;
            }
            
            let password = '';
            const array = new Uint32Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                password += chars[array[i] % chars.length];
            }
            
            return password;
        }
        
        function generateMemorablePassword(length) {
            const numWords = Math.ceil(length / 5);
            let password = '';
            
            for (let i = 0; i < numWords; i++) {
                const array = new Uint32Array(1);
                crypto.getRandomValues(array);
                const word = memorableWords[array[0] % memorableWords.length];
                
                // Randomly capitalize
                const array2 = new Uint32Array(1);
                crypto.getRandomValues(array2);
                if (array2[0] % 2 === 0) {
                    password += word.charAt(0).toUpperCase() + word.slice(1);
                } else {
                    password += word;
                }
                
                // Add separator
                if (i < numWords - 1) {
                    const separators = ['-', '_', '.', '#', '@', '$', '%'];
                    const array3 = new Uint32Array(1);
                    crypto.getRandomValues(array3);
                    password += separators[array3[0] % separators.length];
                }
            }
            
            // Trim to exact length
            return password.substring(0, length);
        }
        
        // Calculate password strength
        function calculateStrength(password) {
            if (!password) return { score: 0, label: 'N/A', class: '' };
            
            let score = 0;
            
            // Length checks
            if (password.length >= 8) score += 1;
            if (password.length >= 12) score += 1;
            if (password.length >= 16) score += 1;
            if (password.length >= 20) score += 1;
            
            // Character variety
            if (/[a-z]/.test(password)) score += 1;
            if (/[A-Z]/.test(password)) score += 1;
            if (/[0-9]/.test(password)) score += 1;
            if (/[^a-zA-Z0-9]/.test(password)) score += 1;
            
            // Penalty for common patterns
            if (/(.)\1{2,}/.test(password)) score -= 1;
            if (/^[a-zA-Z]+$/.test(password) || /^[0-9]+$/.test(password)) score -= 1;
            
            // Normalize score
            score = Math.max(0, Math.min(5, score));
            
            let label, className;
            if (score <= 1) { label = 'Very Weak'; className = 'strength-weak'; }
            else if (score <= 2) { label = 'Weak'; className = 'strength-weak'; }
            else if (score <= 3) { label = 'Fair'; className = 'strength-fair'; }
            else if (score <= 4) { label = 'Good'; className = 'strength-good'; }
            else { label = 'Strong'; className = 'strength-strong'; }
            
            return { score, label, className };
        }
        
        // Update strength display
        function updateStrengthDisplay(password) {
            const strength = calculateStrength(password);
            const percentage = (strength.score / 5) * 100;
            
            strengthBar.style.width = percentage + '%';
            strengthBar.className = 'strength-bar ' + strength.className;
            strengthLabel.textContent = 'Password Strength: ' + strength.label;
            strengthLabel.className = 'strength-label text-' + strength.className.replace('strength-', '');
            
            // Show password details
            const hasUpper = /[A-Z]/.test(password);
            const hasLower = /[a-z]/.test(password);
            const hasNumbers = /[0-9]/.test(password);
            const hasSymbols = /[^a-zA-Z0-9]/.test(password);
            
            passwordDetails.innerHTML = `
                <strong>Length:</strong> ${password.length} characters<br>
                <strong>Contains:</strong> ${[
                    hasUpper ? 'Uppercase' : '',
                    hasLower ? 'Lowercase' : '',
                    hasNumbers ? 'Numbers' : '',
                    hasSymbols ? 'Symbols' : ''
                ].filter(Boolean).join(', ')}
            `;
            passwordInfo.style.display = 'block';
        }
        
        // Add to history
        function addToHistory(password) {
            const timestamp = new Date().toLocaleString();
            passwordHistoryList.unshift({ password, timestamp });
            
            // Keep only last 20 passwords
            if (passwordHistoryList.length > 20) {
                passwordHistoryList = passwordHistoryList.slice(0, 20);
            }
            
            localStorage.setItem('passwordHistory', JSON.stringify(passwordHistoryList));
            renderHistory();
        }
        
        // Render history
        function renderHistory() {
            if (passwordHistoryList.length === 0) {
                passwordHistory.innerHTML = '<div class="text-center text-muted py-3">No passwords generated yet</div>';
                return;
            }
            
            passwordHistory.innerHTML = passwordHistoryList.map((item, index) => `
                <div class="history-item">
                    <span class="history-password" title="${item.password}">${item.password}</span>
                    <div>
                        <button class="btn btn-sm btn-outline-primary copy-history-btn" data-password="${item.password}">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Add copy handlers
            document.querySelectorAll('.copy-history-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const password = this.getAttribute('data-password');
                    ToolsHub.copyToClipboard(password);
                    ToolsHub.showToast('Password copied to clipboard!');
                });
            });
        }
        
        // Generate button click
        generateBtn.addEventListener('click', function() {
            const password = generatePassword();
            if (password) {
                generatedPassword.value = password;
                updateStrengthDisplay(password);
                addToHistory(password);
            }
        });
        
        regenerateBtn.addEventListener('click', function() {
            generateBtn.click();
        });
        
        // Copy button click
        copyBtn.addEventListener('click', function() {
            if (generatedPassword.value) {
                ToolsHub.copyToClipboard(generatedPassword.value);
                ToolsHub.showToast('Password copied to clipboard!');
            } else {
                alert('No password to copy');
            }
        });
        
        // Clear history button
        clearHistoryBtn.addEventListener('click', function() {
            passwordHistoryList = [];
            localStorage.removeItem('passwordHistory');
            renderHistory();
            ToolsHub.showToast('History cleared!');
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            renderHistory();
        });
    </script>
    <script src="../js/main.js"></script>
</body>
</html>
