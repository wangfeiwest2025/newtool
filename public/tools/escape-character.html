<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½¬ä¹‰å­—ç¬¦è½¬æ¢ - New ToolsHub</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ› ï¸</text></svg>">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/fontawesome-all.min.css">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#20c997">
    <style>
        .type-option {
            padding: 8px 16px;
            border: 2px solid #e9ecef;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            display: inline-block;
        }
        
        .type-option:hover {
            border-color: #20c997;
        }
        
        .type-option.active {
            background-color: #20c997;
            color: white;
            border-color: #20c997;
        }
        
        .escape-output {
            font-family: 'Courier New', Consolas, monospace;
            font-size: 14px;
            background-color: #1a1a2e;
            color: #00ff88;
            padding: 15px;
            border-radius: 8px;
            min-height: 120px;
            word-break: break-all;
            white-space: pre-wrap;
        }
        
        .escape-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 13px;
        }
        
        .escape-info code {
            background-color: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg" style="background: linear-gradient(135deg, #20c997, #12b886); padding: 1rem 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <div class="container">
            <a class="navbar-brand" href="/" style="color: white; font-weight: 700; display: flex; align-items: center;">
                <i class="fas fa-tools"></i> New ToolsHub
            </a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="tool-container">
            <div class="tool-header">
                <h1 class="tool-title"><i class="fas fa-code"></i> è½¬ä¹‰å­—ç¬¦è½¬æ¢å·¥å…·</h1>
                <p class="tool-description">æ”¯æŒ HTMLã€XMLã€JavaScriptã€Javaã€URLã€Base64ã€CSVã€SQL ç­‰å¤šç§æ ¼å¼çš„è½¬ä¹‰å­—ç¬¦è½¬æ¢ã€‚</p>
            </div>
            
            <div class="tool-content">
                <div class="form-group">
                    <label class="form-label">è½¬æ¢ç±»å‹:</label>
                    <div class="type-selector" id="typeSelector">
                        <div class="type-option active" data-type="html">HTMLå®ä½“</div>
                        <div class="type-option" data-type="xml">XMLå®ä½“</div>
                        <div class="type-option" data-type="url">URLç¼–ç </div>
                        <div class="type-option" data-type="base64">Base64</div>
                        <div class="type-option" data-type="javascript">JavaScript</div>
                        <div class="type-option" data-type="java">Javaå­—ç¬¦ä¸²</div>
                        <div class="type-option" data-type="csv">CSVç‰¹æ®Šå­—ç¬¦</div>
                        <div class="type-option" data-type="sql">SQLç‰¹æ®Šå­—ç¬¦</div>
                    </div>
                </div>
                
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="inputText" class="form-label">è¾“å…¥æ–‡æœ¬:</label>
                            <textarea id="inputText" class="form-control" rows="6" placeholder="åœ¨æ­¤è¾“å…¥è¦è½¬æ¢çš„æ–‡æœ¬..."></textarea>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="outputText" class="form-label">è½¬æ¢ç»“æœ:</label>
                            <div id="outputText" class="escape-output" contenteditable="false"></div>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons mt-3">
                    <button id="encodeBtn" class="btn btn-primary">
                        <i class="fas fa-arrow-right"></i> ç¼–ç /è½¬ä¹‰
                    </button>
                    <button id="decodeBtn" class="btn btn-success">
                        <i class="fas fa-arrow-left"></i> è§£ç /åè½¬ä¹‰
                    </button>
                    <button id="swapBtn" class="btn btn-outline-primary">
                        <i class="fas fa-exchange-alt"></i> äº¤æ¢
                    </button>
                    <button id="clearBtn" class="btn btn-outline-secondary">
                        <i class="fas fa-trash-alt"></i> æ¸…ç©º
                    </button>
                    <button id="copyBtn" class="btn btn-outline-info">
                        <i class="fas fa-copy"></i> å¤åˆ¶ç»“æœ
                    </button>
                </div>
                
                <div class="escape-info" id="escapeInfo">
                    <h5><i class="fas fa-info-circle"></i> å½“å‰æ ¼å¼è¯´æ˜</h5>
                    <div id="formatDescription">
                        <strong>HTMLå®ä½“:</strong> å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“ç¼–ç ï¼Œä¾‹å¦‚ <code>&lt;</code> â†’ <code>&amp;lt;</code>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>New ToolsHub - Inspired by xJavaFxTool | Comprehensive Developer Tools</p>
        </div>
    </footer>

    <script>
        // DOM Elements
        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');
        const typeOptions = document.querySelectorAll('.type-option');
        const encodeBtn = document.getElementById('encodeBtn');
        const decodeBtn = document.getElementById('decodeBtn');
        const swapBtn = document.getElementById('swapBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');
        const formatDescription = document.getElementById('formatDescription');
        
        // State
        let selectedType = 'html';
        
        // Format descriptions
        const formatDescs = {
            html: '<strong>HTMLå®ä½“:</strong> å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“ç¼–ç ï¼Œä¾‹å¦‚ <code>&lt;</code> â†’ <code>&amp;lt;</code>',
            xml: '<strong>XMLå®ä½“:</strong> å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºXMLå®ä½“ç¼–ç ï¼Œä¾‹å¦‚ <code>&lt;</code> â†’ <code>&amp;lt;</code>',
            url: '<strong>URLç¼–ç :</strong> å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºURLç¼–ç ï¼Œä¾‹å¦‚ <code>ç©ºæ ¼</code> â†’ <code>%20</code>',
            base64: '<strong>Base64ç¼–ç :</strong> å°†æ–‡æœ¬è½¬æ¢ä¸ºBase64ç¼–ç æ ¼å¼',
            javascript: '<strong>JavaScriptç¼–ç :</strong> å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºJavaScriptè½¬ä¹‰åºåˆ—ï¼Œä¾‹å¦‚ <code>"</code> â†’ <code>\\"</code>',
            java: '<strong>Javaå­—ç¬¦ä¸²:</strong> å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºJavaå­—ç¬¦ä¸²è½¬ä¹‰ï¼Œä¾‹å¦‚ <code>\n</code> â†’ <code>\\\\n</code>',
            csv: '<strong>CSVç‰¹æ®Šå­—ç¬¦:</strong> å¤„ç†CSVä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆé€—å·ã€æ¢è¡Œã€å¼•å·ï¼‰',
            sql: '<strong>SQLç‰¹æ®Šå­—ç¬¦:</strong> è½¬ä¹‰SQLä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼Œä¾‹å¦‚ <code>\'</code> â†’ <code>\\\'</code>'
        };
        
        // HTML entities mapping
        const htmlEntities = {
            '&': '&amp;',
            '<': '&lt;',
            '>': '&gt;',
            '"': '&quot;',
            "'": '&#39;',
            '/': '&#47;',
            ' ': '&nbsp;'
        };
        
        const htmlEntitiesReverse = {
            '&amp;': '&',
            '&lt;': '<',
            '&gt;': '>',
            '&quot;': '"',
            '&#39;': "'",
            '&#47;': '/',
            '&nbsp;': ' '
        };
        
        // Type selection
        typeOptions.forEach(option => {
            option.addEventListener('click', function() {
                typeOptions.forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                selectedType = this.getAttribute('data-type');
                formatDescription.innerHTML = formatDescs[selectedType];
            });
        });
        
        // Encoding functions
        function encodeHTML(text) {
            return text.replace(/[&<>"'\/ ]/g, char => htmlEntities[char] || char);
        }
        
        function decodeHTML(text) {
            return text.replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&#47;|&nbsp;/g, char => htmlEntitiesReverse[char] || char);
        }
        
        function encodeURL(text) {
            return encodeURIComponent(text);
        }
        
        function decodeURL(text) {
            return decodeURIComponent(text);
        }
        
        function encodeBase64(text) {
            return btoa(text);
        }
        
        function decodeBase64(text) {
            try {
                return atob(text);
            } catch (e) {
                throw new Error('Invalid Base64 input');
            }
        }
        
        function encodeJavaScript(text) {
            return text
                .replace(/\\/g, '\\\\')
                .replace(/"/g, '\\"')
                .replace(/'/g, "\\'")
                .replace(/\n/g, '\\n')
                .replace(/\r/g, '\\r')
                .replace(/\t/g, '\\t')
                .replace(/</g, '\\x3C')
                .replace(/>/g, '\\x3E');
        }
        
        function decodeJavaScript(text) {
            return text
                .replace(/\\x3C/g, '<')
                .replace(/\\x3E/g, '>')
                .replace(/\\n/g, '\n')
                .replace(/\\r/g, '\r')
                .replace(/\\t/g, '\t')
                .replace(/\\'/g, "'")
                .replace(/\\"/g, '"')
                .replace(/\\\\/g, '\\');
        }
        
        function encodeJava(text) {
            return text
                .replace(/\\/g, '\\\\')
                .replace(/"/g, '\\"')
                .replace(/'/g, "\\'")
                .replace(/\n/g, '\\n')
                .replace(/\r/g, '\\r')
                .replace(/\t/g, '\\t');
        }
        
        function decodeJava(text) {
            return text
                .replace(/\\n/g, '\n')
                .replace(/\\r/g, '\r')
                .replace(/\\t/g, '\t')
                .replace(/\\'/g, "'")
                .replace(/\\"/g, '"')
                .replace(/\\\\/g, '\\');
        }
        
        function encodeCSV(text) {
            // Escape commas, quotes, and newlines for CSV
            if (text.includes(',') || text.includes('"') || text.includes('\n')) {
                text = '"' + text.replace(/"/g, '""') + '"';
            }
            return text;
        }
        
        function decodeCSV(text) {
            if (text.startsWith('"') && text.endsWith('"')) {
                text = text.slice(1, -1).replace(/""/g, '"');
            }
            return text;
        }
        
        function encodeSQL(text) {
            return text
                .replace(/'/g, "''")
                .replace(/\\/g, '\\\\');
        }
        
        function decodeSQL(text) {
            return text
                .replace(/''/g, "'")
                .replace(/\\\\/g, '\\');
        }
        
        // Process text based on selected type and mode
        function processText(mode) {
            const text = inputText.value;
            if (!text) {
                alert('è¯·è¾“å…¥è¦è½¬æ¢çš„æ–‡æœ¬');
                return;
            }
            
            try {
                let result;
                const resetButton = ToolsHub.showLoading(mode === 'encode' ? encodeBtn : decodeBtn);
                
                switch (selectedType) {
                    case 'html':
                        result = mode === 'encode' ? encodeHTML(text) : decodeHTML(text);
                        break;
                    case 'xml':
                        result = mode === 'encode' ? encodeHTML(text) : decodeHTML(text);
                        break;
                    case 'url':
                        result = mode === 'encode' ? encodeURL(text) : decodeURL(text);
                        break;
                    case 'base64':
                        result = mode === 'encode' ? encodeBase64(text) : decodeBase64(text);
                        break;
                    case 'javascript':
                        result = mode === 'encode' ? encodeJavaScript(text) : decodeJavaScript(text);
                        break;
                    case 'java':
                        result = mode === 'encode' ? encodeJava(text) : decodeJava(text);
                        break;
                    case 'csv':
                        result = mode === 'encode' ? encodeCSV(text) : decodeCSV(text);
                        break;
                    case 'sql':
                        result = mode === 'encode' ? encodeSQL(text) : decodeSQL(text);
                        break;
                    default:
                        result = text;
                }
                
                outputText.textContent = result;
                resetButton();
            } catch (error) {
                alert('è½¬æ¢é”™è¯¯: ' + error.message);
            }
        }
        
        // Event listeners
        encodeBtn.addEventListener('click', () => processText('encode'));
        decodeBtn.addEventListener('click', () => processText('decode'));
        
        swapBtn.addEventListener('click', function() {
            const temp = inputText.value;
            inputText.value = outputText.textContent;
            outputText.textContent = temp;
        });
        
        clearBtn.addEventListener('click', function() {
            inputText.value = '';
            outputText.textContent = '';
        });
        
        copyBtn.addEventListener('click', function() {
            const text = outputText.textContent;
            if (text) {
                ToolsHub.copyToClipboard(text);
                ToolsHub.showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!');
            } else {
                alert('æ²¡æœ‰å†…å®¹å¯å¤åˆ¶');
            }
        });
    </script>
    <script src="../js/main.js"></script>
</body>
</html>
